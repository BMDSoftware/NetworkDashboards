[tox]
skipsdist = true
envlist =
    black
    isort
    mypy
    prospector
    tests

[testenv]
setenv = SECRET_KEY = secret

[testenv:black]
basepython = python3.8
deps = -r{toxinidir}/dashboard_viewer/requirements-dev.txt
commands = black --check --diff --exclude venv*|superset .

[testenv:isort]
basepython = python3.8
deps = -r{toxinidir}/dashboard_viewer/requirements-dev.txt
commands = isort --check-only --diff --recursive --skip-glob venv* --skip-glob superset .

[testenv:mypy]
basepython = python3.8
deps = -r{toxinidir}/dashboard_viewer/requirements-dev.txt
changedir = {toxinidir}/dashboard_viewer
commands = mypy .

[testenv:prospector]
basepython = python3.8
deps =
    -r{toxinidir}/dashboard_viewer/requirements-dev.txt
    -r{toxinidir}/dashboard_viewer/requirements.txt
commands = prospector -I venv* -I superset .

[testenv:tests]
basepython = python3.8
changedir = {toxinidir}/dashboard_viewer
deps =
    -r{toxinidir}/dashboard_viewer/requirements-dev.txt
    -r{toxinidir}/dashboard_viewer/requirements.txt
passenv = SECRET_KEY
commands = {envpython} manage.py test
